from transformers import T5Tokenizer
from model import T5QA

tokenizer = T5Tokenizer.from_pretrained('t5-base')
model = T5QA.load_from_checkpoint('best-checkpoint.ckpt', model_name_or_path='t5-base')

context = """"The term `` campomelic '' comes Greek words `` bent limb . '' Affected individuals typically born bowing long bones legs , occasionally , bowing arms . Bowing cause characteristic skin dimples form curved bone , especially lower legs . People campomelic dysplasia usually short legs , dislocated hips , underdeveloped shoulder blades , 11 pairs ribs instead 12 , bone abnormalities neck , inward- upward-turning feet  . These skeletal abnormalities begin developing birth often seen ultrasound . When affected individuals features disorder bowed limbs , said acampomelic campomelic dysplasia.Many people campomelic dysplasia external genitalia look clearly male clearly female  . Approximately 75 percent affected individuals typical male chromosome pattern  ambiguous genitalia normal female genitalia . Internal reproductive organs may correspond external genitalia ; internal organs male  , female  , combination two . For example , individual female external genitalia may testes combination testes ovaries.Affected individuals distinctive facial features , including small chin , prominent eyes , flat face . They also large head compared body size . A particular group physical features , called Pierre Robin sequence , common people campomelic dysplasia . Pierre Robin sequence includes opening roof mouth  , tongue placed back normal  , small lower jaw  . People campomelic dysplasia often born weakened cartilage forms upper respiratory tract . This abnormality , called laryngotracheomalacia , partially blocks airway causes difficulty breathing . Laryngotracheomalacia contributes poor survival infants campomelic dysplasia.Mutations near SOX9 gene cause campomelic dysplasia . This gene provides instructions making protein plays critical role formation many different tissues organs embryonic development . The SOX9 protein regulates activity genes , especially important development skeleton reproductive organs.Most cases campomelic dysplasia caused mutations within SOX9 gene . These mutations prevent production SOX9 protein result protein impaired function . About 5 percent cases caused chromosome abnormalities occur near SOX9 gene ; cases tend milder caused mutations within SOX9 gene . The chromosome abnormalities disrupt regions DNA normally regulate activity SOX9 gene . All genetic changes prevent SOX9 protein properly controlling genes essential normal development skeleton , reproductive system , parts body . Abnormal development structures causes signs symptoms campomelic dysplasia.Campomelic dysplasia inherited autosomal dominant pattern , means one copy altered gene cell sufficient cause disorder . Most cases result new mutations near SOX9 gene occur people history disorder family . Rarely , affected individuals inherit chromosome abnormality parent may may show mild signs symptoms campomelic dysplasia.Barone C , Bartoloni G , Baffico AM , Pappalardo E , Mura I , Ettore G , Bianca S.Novel c.358C > T mutation SOX9 gene prenatal diagnosis campomelicdysplasia . Congenit Anom  . 2014 Aug ; 54  :193-4. doi : 10.1111/cga.12054.No abstract available . Citation PubMedBeaulieu Bergeron M , Lemyre E , Rypens F , Scherer G , Lemieux N , Fournet JC.Diagnosis true hermaphroditism fetus acampomelic campomelicdysplasia . Prenat Diagn . 2009 May ; 29  :528-30. doi : 10.1002/pd.2187 . No abstractavailable . Citation PubMedBien-Willner GA , Stankiewicz P , Lupski JR. SOX9cre1 , cis-acting regulatoryelement located 1.1 Mb upstream SOX9 , mediates enhancement SHHpathway . Hum Mol Genet . 2007 May 15 ; 16  :1143-56. doi : 10.1093/hmg/ddm061 . Epub2007 Apr 4 . Citation PubMedHill-Harfe KL , Kaplan L , Stalker HJ , Zori RT , Pop R , Scherer G , Wallace MR.Fine mapping chromosome 17 translocation breakpoints > = 900 Kb upstreamof SOX9 acampomelic campomelic dysplasia mild , familial skeletaldysplasia . Am J Hum Genet . 2005 Apr ; 76  :663-71. doi : 10.1086/429254 . Citation PubMed Free article PubMed CentralKobayashi A , Chang H , Chaboissier MC , Schedl A , Behringer RR . Sox9 testisdetermination . Ann N Y Acad Sci . 2005 Dec ; 1061:9-17. doi:10.1196/annals.1336.003 . Citation PubMedLeipoldt M , Erdel M , Bien-Willner GA , Smyk M , Theurl M , Yatsenko SA , LupskiJR , Lane AH , Shanske AL , Stankiewicz P , Scherer G. Two novel translocationbreakpoints upstream SOX9 define borders proximal distal breakpointcluster region campomelic dysplasia . Clin Genet . 2007 Jan ; 71  :67-75. doi:10.1111/j.1399-0004.2007.00736.x . Citation PubMedMansour S , Offiah AC , McDowall S , Sim P , Tolmie J , Hall C. The phenotype ofsurvivors campomelic dysplasia . J Med Genet . 2002 Aug ; 39  :597-602. doi:10.1136/jmg.39.8.597 . No abstract available . Citation PubMed Free article PubMed CentralNelson ME , Griffin GR , Innis JW , Green GE . Campomelic dysplasia : airwaymanagement two patients update clinical-molecular correlations inthe head neck . Ann Otol Rhinol Laryngol . 2011 Oct ; 120  :682-5. doi:10.1177/000348941112001009 . Citation PubMedPop R , Zaragoza MV , Gaudette M , Dohrmann U , Scherer G. A homozygous nonsensemutation SOX9 dominant disorder campomelic dysplasia : case mitoticgene conversion . Hum Genet . 2005 Jun ; 117  :43-53. doi:10.1007/s00439-005-1295-y . Epub 2005 Apr 2 . Citation PubMedSmyk M , Obersztyn E , Nowakowska B , Bocian E , Cheung SW , Mazurczak T , Stankiewicz P. Recurrent SOX9 deletion campomelic dysplasia due somaticmosaicism father . Am J Med Genet A . 2007 Apr 15 ; 143A  :866-70. doi:10.1002/ajmg.a.31631 . Citation PubMedUnger S , Scherer G , Superti-Furga A. Campomelic Dysplasia . 2008 Jul 31 [ updated 2023 Apr 6 ] . In : Adam MP , Mirzaa GM , Pagon RA , Wallace SE , Bean LJH , Gripp KW , Amemiya A , editors . GeneReviews  [ Internet ] . Seattle  : University Washington , Seattle ; 1993-2023 . Available fromhttp : //www.ncbi.nlm.nih.gov/books/NBK1760/ Citation PubMedVelagaleti GV , Bien-Willner GA , Northup JK , Lockhart LH , Hawkins JC , Jalal SM , Withers M , Lupski JR , Stankiewicz P. Position effects due chromosomebreakpoints map approximately 900 Kb upstream approximately 1.3 Mbdownstream SOX9 two patients campomelic dysplasia . Am J Hum Genet.2005 Apr ; 76  :652-62. doi : 10.1086/429252 . Epub 2005 Feb 22 . Citation PubMed Free article PubMed Central"
"""
question = """'What is  campomelic dysplasia ?'
"""

input_text = question + ' [SEP] ' + context

encoded = tokenizer.encode_plus(input_text, max_length=512, padding='max_length', truncation=True, add_special_tokens=True, return_tensors='pt')
input_ids = encoded['input_ids']

output = model.predict_step(input_ids)
print(output)